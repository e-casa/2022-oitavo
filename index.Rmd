---
title: "Análise Global Oitavo Ano"
author: "E-Casa"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: yes
    toc_float:
      collapsed: no
      smooth_scroll: yes
    toc_depth: 5
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(formattable)
library(kableExtra)
library(janitor)
library(ggrepel)
library(knitr)
library(DT)
library(viridis)
library(hrbrthemes)
library(readxl)
library(itan)

knitr::opts_chunk$set(tidy = FALSE,
                      fig.width = 10,
                      fig.height = 8,
                      warning = FALSE,
                      message =FALSE,
                      echo = FALSE)


respostas <- read_excel("microdados-GR8.xlsx")

respostas <- respostas[-c(1:2),]


respostas_dados <- respostas[,-c(1:4)]


colnames(respostas_dados) <- c( "P1", "P2", "P3", "P4", "P5", "P6", "P7", "P8", "P9", "P10", "M1", "M2", "M3", "M4", "M5", "M6", "M7", "M8" , "M9", "M10")


clave <- data.frame(
  questões = c( "P1", "P2", "P3", "P4", "P5", "P6", "P7", "P8", "P9", "P10", "M1", "M2", "M3", "M4", "M5", "M6", "M7", "M8" , "M9", "M10"), 
  gabarito= c( "A", "A", "C" ,"C" , "D", "B", "B", "D", "C", "C", "D", "C", "C", "D", "B", "D", "A", "C", "B", "D")
)


clave_t <- clave %>% t %>% as.data.frame() %>% row_to_names(1)

```

## Obrigado

Estamos muito contentes com seu interesse por esse relatório. 
Aqui, muito mais do que apresentar os resultados obtidos nos diferentes itens esperamos criar condições para discutirmos e melhorarmos, juntos, a qualidade da educação em nossa Rede.

Nesse relatório você encontrará..... 



## Análise da Rede 

Percentual de respostas a cada uma das questões 

```{r, echo=FALSE }
alternativas <- LETTERS[1:4]

respostas_freq <- calcularFrecuenciaAlternativas(
          respostas_dados,
          alternativas,
          clave = NULL,
          frecuencia = FALSE,
          digitos = 2
          )

respostas_freq_tot <- respostas_freq %>% mutate( Total = A+B+C+D+`NA` , `%A` = percent( A / Total, 2), `%B` = percent( B / Total, 2), `%C` = percent( C / Total, 2), `%D` = percent( D / Total, 2), `%NA` = percent( `NA` / Total, 2))  

respostas_freq_tot_P <- respostas_freq_tot[-c(11:20),-c(2:7)]

  

kable(as_tibble(respostas_freq_tot_P), booktabs = TRUE) %>%
  kable_styling(font_size = 12,bootstrap_options = "striped", full_width = F, position = "center")





```
Análise das respostas de Matemática 

```{r, echo=FALSE }


respostas_freq_tot_M <- respostas_freq_tot[-c(1:10),-c(2:7)]

  

kable(as_tibble(respostas_freq_tot_M), booktabs = TRUE) %>%
  kable_styling(font_size = 12,bootstrap_options = "striped", full_width = F, position = "center")

```


## Análise das notas por escola



```{r , echo=FALSE}


respostas_corretas <- corregirRespuestas( respostas_dados, clave_t)



pontuacoes <- calcularPuntajes( respostas_corretas)

Resultado <- cbind( respostas[,-c(5:24)], Pontuações = pontuacoes)


#### corrigir só portugues 



respostas_dados_port <- respostas_dados[,-c(11:20)]





clave_port <- data.frame(
  questões = c( "P1", "P2", "P3", "P4", "P5", "P6", "P7", "P8", "P9", "P10"), 
  gabarito= c( "A", "A", "C" ,"C" , "D", "B", "B", "D", "C", "C")
)



### https://cran.rstudio.com/web/packages/itan/itan.pdf


clave_t_port <- clave_port %>% t %>% as.data.frame() %>% row_to_names(1)



####  calcular respostas corretas para os estudantes 

respostas_corretas <- corregirRespuestas( respostas_dados_port, clave_t_port)

pontuacoes <- calcularPuntajes( respostas_corretas)

Resultado <- cbind( Resultado, Pontuações_Português = pontuacoes)


### calcular notas mat

respostas_dados_mat <- respostas[,-c(1:14)]


colnames(respostas_dados_mat) <- c(  "M1", "M2", "M3", "M4", "M5", "M6", "M7", "M8" , "M9", "M10")


clave_mat <- data.frame(
  questões = c(  "M1", "M2", "M3", "M4", "M5", "M6", "M7", "M8" , "M9", "M10"), 
  gabarito= c( "D", "C",  "C", "D", "B", "D", "A", "C", "B", "D")
)


clave_t_mat <- clave_mat %>% t %>% as.data.frame() %>% row_to_names(1)


####  calcular respostas corretas para os estudantes 

respostas_corretas <- corregirRespuestas( respostas_dados_mat, clave_t_mat)

pontuacoes <- calcularPuntajes( respostas_corretas)

Resultado <- cbind(Resultado, Pontuações_Matemática = pontuacoes)


Resultado_nota <- Resultado %>% group_by( AnoEscolar) %>% summarise(nota = round(mean( Pontuações),2) , nota_Português = round(mean( Pontuações_Português),2) ,  nota_Matemática = round(mean( Pontuações_Matemática),2))

kable(Resultado_nota, booktabs = TRUE) %>%
  kable_styling(font_size = 12,bootstrap_options = "striped", full_width = F, position = "center")

```






```{r , echo=FALSE}



Resultado_nota <- Resultado %>% group_by( Escola) %>% summarise(nota = round(mean( Pontuações),2) , nota_Português = round(mean( Pontuações_Português),2) ,  nota_Matemática = round(mean( Pontuações_Matemática),2))

kable(Resultado_nota, booktabs = TRUE) %>%
  kable_styling(font_size = 12,bootstrap_options = "striped", full_width = F, position = "center")

```
## Resultados das turmas por escola

### E.M. ALTIVO CÉSAR



```{r, echo=FALSE}


Resultado_nota_group <- Resultado %>% group_by( Escola, Turma) %>% summarise(nota = round(mean( Pontuações),2) , nota_Português = round(mean( Pontuações_Português),2) ,  nota_Matemática = round(mean( Pontuações_Matemática),2))

Resultado_nota_esc <- Resultado_nota_group %>% filter( Escola == "E.M. ALTIVO CÉSAR")


Resultado_nota_esc$Escola  <- NULL 
kbl(as_tibble(Resultado_nota_esc), booktabs = TRUE) %>%
  kable_styling(font_size = 12, bootstrap_options = "striped", full_width = F, position = "center")

```
#### GR 8A - 2022 GR8 - 8º ano ENSINO FUNDAMENTAL


```{r, echo=FALSE}


Resultado_nota_t <- Resultado %>% group_by( Escola, Turma, Aluno) %>% summarise(nota = round(mean( Pontuações),2) , nota_Português = round(mean( Pontuações_Português),2) ,  nota_Matemática = round(mean( Pontuações_Matemática),2))

Resultado_nota_t <- Resultado_nota_t %>% filter( Escola == "E.M. ALTIVO CÉSAR" , Turma == "GR 8A - 2022 GR8 - 8º ano ENSINO FUNDAMENTAL")


Resultado_nota_t$Escola  <- NULL 

Resultado_nota_t$Turma <- NULL 

Resultado_nota_t <- Resultado_nota_t %>% arrange (Aluno)

kbl(Resultado_nota_t, booktabs = TRUE) %>%
  kable_styling(font_size = 12, bootstrap_options = "striped", full_width = F, position = "center")

```

##### Respostas - Português


```{r, echo=FALSE}

alternativas <- corregirRespuestas(respostas_dados, clave_t)

alternativas_lado <- alternativas[,-c(11:20)]

alternativas <- cbind(respostas[,c(1:4)], alternativas_lado, Resultado[[6]])



alternativas_t <- alternativas %>% filter( Escola == "E.M. ALTIVO CÉSAR" , Turma == "GR 8A - 2022 GR8 - 8º ano ENSINO FUNDAMENTAL")


alternativas_t$Escola  <- NULL 

alternativas_t$Turma <- NULL 

alternativas_t$AnoEscolar <- NULL 

colnames(alternativas_t)[12] <- "Nota Português"

alternativas_t <- alternativas_t %>% arrange( Aluno)

kbl(as_tibble(alternativas_t), booktabs = TRUE) %>%
  kable_styling(font_size = 12, bootstrap_options = "striped", full_width = F, position = "center")

```
##### Notas Matemática

```{r, echo=FALSE}

alternativas <- corregirRespuestas(respostas_dados, clave_t)

alternativas_lado <- alternativas[,-c(1:10)]

alternativas <- cbind(respostas[,c(1:4)], alternativas_lado, Resultado[[7]])



alternativas_t <-alternativas %>% filter( Escola == "E.M. ALTIVO CÉSAR" , Turma == "GR 8A - 2022 GR8 - 8º ano ENSINO FUNDAMENTAL")


alternativas_t$Escola  <- NULL 

alternativas_t$Turma <- NULL 

alternativas_t$AnoEscolar <- NULL 

alternativas_t <- alternativas_t %>% arrange(Aluno)

colnames(alternativas_t)[12] <- "Nota Matemática"

kbl(as_tibble(alternativas_t), booktabs = TRUE) %>%
  kable_styling(font_size = 12, bootstrap_options = "striped", full_width = F, position = "center")

```


